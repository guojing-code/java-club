状态机
state machine